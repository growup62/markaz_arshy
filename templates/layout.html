<!DOCTYPE html>
<html lang="id" class="antialiased">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}{% endblock %} - Markaz Arshy</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@2.8.2/dist/alpine.min.js" defer></script>
    <style>
        /* Mengaplikasikan font Inter ke body */
        body {
            font-family: 'Inter', sans-serif;
            /* --- Bagian Background AI Robot Trading --- */
            background-image: url("{{ url_for('static', filename='images/ai-trading-bg.jpg') }}"); /* Ganti dengan path gambar Anda */
            background-size: cover; /* Memastikan gambar menutupi seluruh area */
            background-position: center; /* Memusatkan gambar */
            background-repeat: no-repeat; /* Mencegah pengulangan gambar */
            background-attachment: fixed; /* Membuat background tetap saat scroll */
            /* Tambahkan overlay gelap agar teks tetap terbaca */
            background-color: rgba(0, 0, 0, 0.6); /* Warna overlay (hitam dengan 60% opacity) */
            background-blend-mode: overlay; /* Mode blend untuk mencampurkan warna overlay */
            /* --- Akhir Bagian Background AI Robot Trading --- */
        }
        /* Custom styles for flash messages for consistent icon/dismiss layout */
        .flash-message {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); /* shadow-sm */
            transition: all 0.3s ease-in-out; /* duration-300 */
        }
        .flash-message .close-button {
            margin-left: auto;
            background-color: transparent;
            border: none;
            cursor: pointer;
            padding: 0.375rem; /* p-1.5 */
            border-radius: 0.375rem; /* rounded-lg */
            font-size: 1.25rem; /* text-xl */
        }
        /* Penyesuaian untuk input file agar terlihat lebih konsisten */
        input[type="file"]::file-selector-button {
            background-color: theme('colors.blue.50'); /* bg-blue-50 */
            color: theme('colors.blue.700'); /* text-blue-700 */
            font-size: theme('fontSize.sm'); /* text-sm */
            font-weight: theme('fontWeight.semibold'); /* font-semibold */
            border: 0;
            padding: 0.5rem 1rem; /* py-2 px-4 */
            margin-right: 1rem; /* mr-4 */
            border-radius: 0.375rem; /* rounded-md */
            transition: background-color 0.2s ease-in-out;
        }
        input[type="file"]::file-selector-button:hover {
            background-color: theme('colors.blue.100'); /* hover:bg-blue-100 */
        }
        /* Style untuk overlay saat menu mobile terbuka */
        .mobile-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent black */
            z-index: 40; /* Di bawah navbar (z-50) tapi di atas konten utama */
            transition: opacity 0.3s ease-in-out;
        }
    </style>
</head>
<body class="font-sans min-h-screen flex flex-col">
    <nav class="bg-blue-700 text-white p-4 sticky top-0 z-50" x-data="{ open: false }" @keydown.escape="open = false">
        <div class="container mx-auto flex justify-between items-center">
            <div class="text-2xl font-bold">Markaz Arshy</div>
            <button class="md:hidden focus:outline-none" @click="open = !open" aria-label="Toggle menu">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" :d="open ? 'M6 18L18 6M6 6l12 12' : 'M4 6h16M4 12h16m-7 6h7'"></path>
                </svg>
            </button>
            <div class="md:flex space-x-4 transition-all duration-300 ease-in-out" 
                 :class="{ 'flex flex-col md:flex-row mt-4 md:mt-0 space-y-2 md:space-y-0 md:space-x-4 items-center': open, 'hidden': !open }" 
                 x-show="open || window.innerWidth >= 768"
                 x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 -translate-y-4"
                 x-transition:enter-end="opacity-100 translate-y-0"
                 x-transition:leave="transition ease-in duration-200"
                 x-transition:leave-start="opacity-100 translate-y-0"
                 x-transition:leave-end="opacity-0 -translate-y-4"
            >
                {% if 'admin_id' in session %}
                    <a href="{{ url_for('admin_dashboard') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Admin Panel</a>
                    <a href="{{ url_for('admin_dashboard') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Manajemen User</a>
                    <a href="{{ url_for('status_page') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Status Sinyal</a>
                    <a href="{{ url_for('admin_logout') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Logout Admin</a>
                {% elif 'user_id' in session %}
                    <a href="{{ url_for('dashboard_page') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Dashboard</a>
                    <a href="{{ url_for('lisensi_page') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">License Saya</a>
                    <a href="{{ url_for('subscribe_page') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Langganan</a>
                    <a href="{{ url_for('panduan_page') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Panduan</a>
                    <a href="{{ url_for('download_ea') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Download EA</a>
                    <a href="{{ url_for('status_page') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Status Sinyal</a>
                    <a href="{{ url_for('logout') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Logout</a>
                {% else %}
                    <a href="{{ url_for('login_page') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Login</a>
                    <a href="{{ url_for('register_page') }}" class="hover:bg-blue-800 px-3 py-2 rounded transition duration-200">Register</a>
                {% endif %}
            </div>
        </div>
    </nav>
    <div x-show="open" @click="open = false" x-transition.opacity class="mobile-menu-overlay md:hidden"></div>

    <main class="container mx-auto flex-grow p-4 sm:p-6 md:p-8">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="mb-6 space-y-2">
                    {% for category, message in messages %}
                        <div id="flash-{{ loop.index }}" class="flash-message 
                                    bg-{{ 'green' if category in ['info', 'success'] else 'red' if category == 'danger' else 'yellow' if category == 'warning' else 'blue' }}-100
                                    border-{{ 'green' if category in ['info', 'success'] else 'red' if category == 'danger' else 'yellow' if category == 'warning' else 'blue' }}-400
                                    text-{{ 'green' if category in ['info', 'success'] else 'red' if category == 'danger' else 'yellow' if category == 'warning' else 'blue' }}-700" 
                                    role="alert">
                            <div class="flex items-center">
                                {% if category in ['info', 'success'] %}
                                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                                {% elif category == 'danger' %}
                                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg>
                                {% elif category == 'warning' %}
                                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.333 2.647-1.333 3.412 0l7.258 12.603c.792 1.376-.073 3.003-1.701 3.003H2.74c-1.628 0-2.493-1.627-1.701-3.003L8.257 3.099zM10 6a1 1 0 011 1v4a1 1 0 11-2 0V7a1 1 0 011-1zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg>
                                {% else %}
                                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20"><path d="M2 10a8 8 0 1116 0 8 8 0 01-16 0zM9 9a1 1 0 000 2h2a1 1 0 100-2H9z" clip-rule="evenodd" fill-rule="evenodd"></path></svg>
                                {% endif %}
                                <span>{{ message }}</span>
                            </div>
                            <button type="button" class="close-button bg-{{ 'green' if category in ['info', 'success'] else 'red' if category == 'danger' else 'yellow' if category == 'warning' else 'blue' }}-50 text-{{ 'green' if category in ['info', 'success'] else 'red' if category == 'danger' else 'yellow' if category == 'warning' else 'blue' }}-500 rounded-lg focus:ring-2 focus:ring-{{ 'green' if category in ['info', 'success'] else 'red' if category == 'danger' else 'yellow' if category == 'warning' else 'blue' }}-400 p-1.5 hover:bg-{{ 'green' if category in ['info', 'success'] else 'red' if category == 'danger' else 'yellow' if category == 'warning' else 'blue' }}-200 inline-flex h-8 w-8" data-dismiss-target="#flash-{{ loop.index }}" aria-label="Dismiss">
                                <span class="sr-only">Dismiss</span>
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
                            </button>
                        </div>
                    {% endfor %}
                </div>
                <script>
                    document.querySelectorAll('[data-dismiss-target]').forEach(button => {
                        button.addEventListener('click', () => {
                            const targetId = button.getAttribute('data-dismiss-target');
                            const elementToRemove = document.querySelector(targetId);
                            if (elementToRemove) {
                                elementToRemove.remove();
                            }
                        });
                    });
                    // Auto-dismiss after 5 seconds
                    setTimeout(() => {
                        document.querySelectorAll('.flash-message').forEach(msg => msg.remove());
                    }, 5000);
                </script>
            {% endif %}
        {% endwith %}
        {% block content %}
        {% endblock %}
    </main>
    <footer class="bg-blue-700 text-white text-center p-4 mt-auto">
        <p>© 2025 Markaz Arshy. All rights reserved.</p>
    </footer>
</body>
</html>